<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">




<!--
    namespace 命名空间
-->
<mapper namespace="Random.springboot_demo.config.itheima.mapper.UserMapper">

<!--    <sql id="user_column">-->
<!--        user_id as userId, user_name as userName,-->
<!--        user_email as userEmail, user_score as userScore,-->
<!--        user_rank as userRank-->
<!--    </sql>-->

<!--注意这里type应该指明是哪一个类 不然的话 这些都是错误的-->
    <resultMap id="userResultMap" type="Random.springboot_demo.config.itheima.pojo.User">
        <result column="user_name" property="userName" />
        <result column="user_id" property="userId" />
        <result column="user_email" property="userEmail" />
        <result column="user_score" property="userScore" />
        <result column="user_rank" property="userRank" />
    </resultMap>


    <!--    statement-->
    <select id="selectAll" resultType="Random.springboot_demo.config.itheima.pojo.User">
        select *
        from User
    </select>
    <select id="selectById" resultMap="userResultMap" parameterType="int">
<!--        select <include refid="user_column"></include>-->
<!--        from user-->
<!--        where user_id = #{id};-->
        select *
        from user
        where user_id = #{id};
    </select>

<!--    <select id="selectByCondition" resultMap="userResultMap">-->
<!--        select *-->
<!--        from user-->
<!--        where-->
<!--            user_email like #{userEmail}-->
<!--        and user_score = #{userScore}-->
<!--    </select>-->

    <select id="selectByCondition" resultMap="userResultMap">
        select *
        from user
        <where>
            <if test="userEmail != null and userEmail != '' " >
                user_email like #{userEmail}
            </if>
            <if test="userScore != null and userScore != '' ">
                and user_score = #{userScore}
            </if>
        </where>
    </select>
    <select id="selectByMap" resultMap="userResultMap">
        select *
        from user
        where user_id = #{user.userId}
    </select>

    <insert id="add" parameterType="Random.springboot_demo.config.itheima.pojo.User" useGeneratedKeys="true" keyProperty="userId">
        insert
        into user(user_name, user_id, user_email, user_score, user_rank)
        values (#{userName}, #{userId}, #{userEmail}, #{userScore}, #{userRank});
    </insert>

    <update id="update">
        update user
        <set>
            <if test="userEmail != null and userEmail != '' ">
                user_email = #{userEmail},
            </if>
            <if test="userName != null and userName != ''">
                user_name = #{userName},
            </if>
            <if test="userScore != null and userScore != ''">
                user_score = #{userScore},
            </if>
            <if test="userRank != null and userRank != ''">
                user_rank = #{userRank}
            </if>
        </set>
        where user_id = #{userId}
    </update>


    <delete id="deleteById">
        delete
        from user
        where user_id = #{userId}
    </delete>
    <delete id="deleteByIds">
        delete
        from user
        where user_id in
#         for each 的collection 是传进来的数组  item是项 用来遍历使用 open和clsoe是用来最后生成的结果 separate用于指定生成结构的分割符号
        <foreach collection="userIds" item="userId" open="(" close=")" separator=",">
            #{userId}
        </foreach>
    </delete>
</mapper>